<krpano version="1.20.11" title="Virtual Tour">

	<include url="%VIEWER%/plugins/combobox.xml" />

	<action name="comboboxexamples" keep="true" autorun="onstart">
		loadscene(0);
	</action>

	<!-- grid preview pano -->
	<!-- <preview type="grid(cube,16,16,512,0xCCCCCC,0xFFFFFF,0x999999);" /> -->

	<!-- vignetting image -->
	<plugin name="mask" keep="true" url="%ROOT%/panos/assets/vignetting.png" width="100%" height="100%" safearea="false" enabled="false" zorder="0" alpha="0" onloaded="tween(alpha,1);" />
	
	<!-- enable autorotation -->
	<autorotate enabled="true" waittime="3.0" accel="0.5" speed="3" horizon="0" tofov="100" keep="true"/>
	

	<!-- compass with rotating pointer -->
	<layer name="compass1" keep="true" url="%ROOT%/panos/assets/compass_bg.png" align="lefttop" x="10" y="10" children="false" scalechildren="true" destscale="1.0" onclick="switch(destscale,1.0,0.5);tween(scale,get(destscale));">
		<layer name="compass1_plate"   url="%ROOT%/panos/assets/compass_plate.png"   align="center"  zorder="1" />
		<layer name="compass1_pointer" url="%ROOT%/panos/assets/compass_pointer.png" align="center"  zorder="2" />
		<layer name="compass1_ring"    url="%ROOT%/panos/assets/compass_ring.png"    align="lefttop" zorder="3" />
	</layer>
	
	<!-- compass with rotating plate -->
	<layer name="compass2" keep="true" url="%ROOT%/panos/assets/compass_bg.png" align="righttop" x="10" y="10" children="false" scalechildren="true" destscale="1.0" onclick="switch(destscale,1.0,0.5);tween(scale,get(destscale));">
		<layer name="compass2_plate"   url="%ROOT%/panos/assets/compass_plate.png"   align="center"  zorder="1" />
		<layer name="compass2_pointer" url="%ROOT%/panos/assets/compass_pointer.png" align="center"  zorder="2" />
		<layer name="compass2_ring"    url="%ROOT%/panos/assets/compass_ring.png"    align="lefttop" zorder="3" />
	</layer>


	<!-- view changing eeent -->
	<events name="compass_events" onviewchange="compass_update_rotate();" keep="true" />

	<!-- update the rotation values -->
	<action name="compass_update_rotate" keep="true">
		set(global_heading, 180);
		calc(plugin[compass1_pointer].rotate, view.hlookat - global_heading);
		calc(plugin[compass2_plate].rotate,  global_heading - view.hlookat);
	</action>


	<!-- add some hotspots -->
	<action name="add_compass_spots" autorun="onstart" keep="true">
		addspot(n,  0,     0|0| 76|76, 1.0);
		addspot(no, 45,   78|0|118|76, 0.5);
		addspot(o,  90,  202|0| 71|76, 1.0);
		addspot(so, 135, 281|0|109|76, 0.5);
		addspot(s,  180, 400|0| 69|76, 1.0);
		addspot(sw, 225, 469|0|134|76, 0.5);
		addspot(w,  270, 603|0| 86|76, 1.0);
		addspot(nw, 315, 689|0|141|76, 0.5);
	</action>
	
	<action name="addspot" keep="true">
		addhotspot(%1);
		set(hotspot[%1].url, '%ROOT%/panos/assets/hotspots.png');
		set(hotspot[%1].crop, '%3');
		set(hotspot[%1].ath, %2);
		set(hotspot[%1].atv, 0);
		set(hotspot[%1].scale, %4);
		set(hotspot[%1].scale1, %4);
		calc(hotspot[%1].scale2, %4 * 2);
		set(hotspot[%1].zoom,true);
		set(hotspot[%1].onover, tween(scale,get(scale2)); );
		set(hotspot[%1].onout, tween(scale,get(scale1)); );
		set(hotspot[%1].onclick, lookto(get(ath),get(atv),90); );
	</action>


	<!-- mixed static/dynamic example - add items dynamically -->
	<combobox name="cbscenes" design="vtour" align="leftbottom" x="10" y="10" onloaded="add_scene_items();" />
	<action name="add_scene_items" scope="local">
		for(set(i,0), i LT scene.count, inc(i),
			caller.additem(calc('[img src=[dq]' + scene[get(i)].thumburl +  '[dq] style=[dq]border:1px solid rgba(255,255,255,0.5);width:48px;height:32px;vertical-align:middle;margin-right:8px;[dq]/] '+scene[get(i)].title), calc('loadscene('+i+',null,MERGE,BLEND(0.5))') );
		);
	</action>

	<!-- static example -->
	<combobox name="cbsettings" design="vtour" align="rightbottom" x="10" y="10" onchange="selectItemByName(0);">
		<item name="item0" caption="SETTINGS" />
		<item name="item1" caption="Drag Control"       onclick="set(control.mode,drag);" />
		<item name="item2" caption="Move Control"       onclick="set(control.mode,moveto);" />
		<item name="item3" caption="Normal View"        onclick="cm_normal_view();" />
		<item name="item4" caption="Fisheye View"       onclick="cm_fisheye_view();" />
		<item name="item5" caption="Stereographic View" onclick="cm_stereographic_view();" />
		<item name="item6" caption="Architectural View" onclick="cm_architectural_view();" />
		<item name="item7" caption="Pannini View"       onclick="cm_pannini_view();" />
		<item name="item8" caption="Little Planet View" onclick="cm_littleplanet_view();" />
	</combobox>

	<!-- full dynamic example -->
	<action name="rebuild_design_selection" autorun="onstart" scope="local" args="design"  onchange="selectItemByName(0);">
		removeComboboxLayer(cbdesigns);
		addComboboxLayer(cbdesigns, get(design));
		set(layer[cbdesigns].align, 'bottom');
		layer[cbdesigns].additem('Select Combobox Design');
		for(set(i,0), i LT combobox_design.count, inc(i),
			layer[cbdesigns].additem( get(combobox_design[get(i)].name), calc('rebuild_design_selection(' + combobox_design[get(i)].name + ');')  );
		);
	</action>


	<!-- some custom example designs -->
	<combobox_design name="rounded" margin="3" open_close_speed="0.25">
		<style name="combobox_container_style"
			bgcolor="0xFFFFFF"
			bgalpha="0.95"
			bgborder="1 0xFFFFFF 0.5"
			bgroundedge="5"
			bgshadow="2 4 20 0x000000 0.5"
			/>
		<style name="combobox_marker_style"
			css="color:#999999;"
			bg="false"
			txtshadow=""
			/>
		<style name="combobox_item_style"
			css="color:#222222;"
			padding="4 4"
			bg="false"
			bgcolor="0xCCCCCC"
			bgalpha="1.0"
			bgroundedge="3"
			txtshadow=""
			onoveritem="set(css, 'color:#2277FF;');"
			onoutitem="set(css, 'color:#222222;');"
			/>
	</combobox_design>

	<combobox_design name="classic" margin="0" open_close_speed="0.25">
		<style name="combobox_container_style"
			bgcolor="0xFFFFFF"
			bgalpha="1.0"
			bgborder="2 0x333333 0.5"
			bgroundedge="0"
			bgshadow=""
			height="50"
			/>
		<style name="combobox_marker_style"
			css="color:#222222;"
			bg="false"
			txtshadow=""
			/>
		<style name="combobox_item_style"
			css="color:#222222;"
			padding="7"
			bg="false"
			bgcolor="0x777777"
			bgalpha="1.0"
			bgroundedge="0"
			txtshadow=""
			onoveritem="set(bg,true); set(css, 'color:#FFFFFF;');"
			onoutitem="set(bg,false); set(css, 'color:#222222;');"
			/>
	</combobox_design>
	
	<combobox_design name="glas" margin="2" open_close_speed="0.25">
		<style name="combobox_container_style"
			bgcolor="0xEEEEEE"
			bgalpha="0.5"
			bgborder="1 0x333333 0.5"
			bgroundedge="5"
			bgshadow="0 4 10 0x000000 0.3"
			height="50"
			/>
		<style name="combobox_marker_style"
			css="color:#222222;"
			alpha="0.7"
			bg="false"
			txtshadow=""
			/>
		<style name="combobox_item_style"
			css="color:#222222;"
			padding="4"
			bg="false"
			bgborder="1 0x333333 0.0"
			bgcolor="0xFFFFFF"
			bgalpha="1"
			bgroundedge="3"
			txtshadow="0 0 4 0xFFFFFF 1"
			onoveritem="set(bg,true); set(bgborder, '1 0x333333 0.5');"
			onoutitem="set(bg,false); set(bgborder, '1 0x333333 0.0');"
			/>
	</combobox_design>


	<!-- include the default contextmenu with different projections -->
	<include url="%VIEWER%/plugins/contextmenu.xml" />


	
	<scene name="scene_nana1" title="nana1" onstart="" havevrimage.mobilevr="false" havevrimage.no-mobilevr="true" thumburl="panos/nana1.tiles/thumb.jpg" lat="" lng="" heading="">
		
		<control bouncinglimits="calc:image.cube ? true : false" />

		<view hlookat="0.0" vlookat="0.0" fovtype="MFOV" fov="120" maxpixelzoom="2.0" fovmin="70" fovmax="140" limitview="auto" />

		<preview url="panos/nana1.tiles/preview.jpg" />

		<image if="!(webvr.isenabled OR device.mobilevr)">
			<cube url="panos/nana1.tiles/%s/l%l/%v/l%l_%s_%v_%h.jpg" multires="512,1024,2048" />
		</image>

		<image if="webvr.isenabled OR device.mobilevr">
			<cube url="panos/nana1.tiles/vr/pano_%s.jpg" />
		</image>

	</scene>

	<scene name="scene_nana2" title="nana2" onstart="" havevrimage.mobilevr="false" havevrimage.no-mobilevr="true" thumburl="panos/nana2.tiles/thumb.jpg" lat="" lng="" heading="">
		
		<control bouncinglimits="calc:image.cube ? true : false" />

		<view hlookat="0.0" vlookat="0.0" fovtype="MFOV" fov="120" maxpixelzoom="2.0" fovmin="70" fovmax="140" limitview="auto" />

		<preview url="panos/nana2.tiles/preview.jpg" />

		<image if="!(webvr.isenabled OR device.mobilevr)">
			<cube url="panos/nana2.tiles/%s/l%l/%v/l%l_%s_%v_%h.jpg" multires="512,1024,2048" />
		</image>

		<image if="webvr.isenabled OR device.mobilevr">
			<cube url="panos/nana2.tiles/vr/pano_%s.jpg" />
		</image>

	</scene>

	<scene name="scene_nana3" title="nana3" onstart="" havevrimage.mobilevr="false" havevrimage.no-mobilevr="true" thumburl="panos/nana3.tiles/thumb.jpg" lat="43.77063235" lng="11.26688837" heading="335.1">
		
		<control bouncinglimits="calc:image.cube ? true : false" />

		<view hlookat="335.1" vlookat="0.0" fovtype="MFOV" fov="120" maxpixelzoom="2.0" fovmin="70" fovmax="140" limitview="auto" />

		<preview url="panos/nana3.tiles/preview.jpg" />

		<image prealign="0|335.1|0" if="!(webvr.isenabled OR device.mobilevr)">
			<cube url="panos/nana3.tiles/%s/l%l/%v/l%l_%s_%v_%h.jpg" multires="512,640,1152,2304" />
		</image>

		<image prealign="0|335.1|0" if="webvr.isenabled OR device.mobilevr">
			<cube url="panos/nana3.tiles/vr/pano_%s.jpg" />
		</image>

	</scene>

	<scene name="scene_nana4" title="nana4" onstart="" havevrimage.mobilevr="false" havevrimage.no-mobilevr="true" thumburl="panos/nana4.tiles/thumb.jpg" lat="" lng="" heading="">
		
		<control bouncinglimits="calc:image.cube ? true : false" />

		<view hlookat="0.0" vlookat="0.0" fovtype="MFOV" fov="120" maxpixelzoom="2.0" fovmin="70" fovmax="140" limitview="auto" />

		<preview url="panos/nana4.tiles/preview.jpg" />

		<image if="!(webvr.isenabled OR device.mobilevr)">
			<cube url="panos/nana4.tiles/%s/l%l/%v/l%l_%s_%v_%h.jpg" multires="512,1024,2048" />
		</image>

		<image if="webvr.isenabled OR device.mobilevr">
			<cube url="panos/nana4.tiles/vr/pano_%s.jpg" />
		</image>

	</scene>

	<scene name="scene_nana5" title="nana5" onstart="" havevrimage.mobilevr="false" havevrimage.no-mobilevr="true" thumburl="panos/nana5.tiles/thumb.jpg" lat="" lng="" heading="">
		
		<control bouncinglimits="calc:image.cube ? true : false" />

		<view hlookat="0.0" vlookat="0.0" fovtype="MFOV" fov="120" maxpixelzoom="2.0" fovmin="70" fovmax="140" limitview="auto" />

		<preview url="panos/nana5.tiles/preview.jpg" />

		<image if="!(webvr.isenabled OR device.mobilevr)">
			<cube url="panos/nana5.tiles/%s/l%l/%v/l%l_%s_%v_%h.jpg" multires="512,1024,2048" />
		</image>

		<image if="webvr.isenabled OR device.mobilevr">
			<cube url="panos/nana5.tiles/vr/pano_%s.jpg" />
		</image>

	</scene>

	<scene name="scene_nana6" title="nana6" onstart="" havevrimage.mobilevr="false" havevrimage.no-mobilevr="true" thumburl="panos/nana6.tiles/thumb.jpg" lat="43.77678833" lng="11.25365000" heading="270.0">
		
		<control bouncinglimits="calc:image.cube ? true : false" />

		<view hlookat="270.0" vlookat="0.0" fovtype="MFOV" fov="120" maxpixelzoom="2.0" fovmin="70" fovmax="140" limitview="auto" />

		<preview url="panos/nana6.tiles/preview.jpg" />

		<image prealign="0|270.0|0" if="!(webvr.isenabled OR device.mobilevr)">
			<cube url="panos/nana6.tiles/%s/l%l/%v/l%l_%s_%v_%h.jpg" multires="512,640,1152,2304" />
		</image>

		<image prealign="0|270.0|0" if="webvr.isenabled OR device.mobilevr">
			<cube url="panos/nana6.tiles/vr/pano_%s.jpg" />
		</image>

	</scene>

	<scene name="scene_nana7" title="nana7" onstart="" havevrimage.mobilevr="false" havevrimage.no-mobilevr="true" thumburl="panos/nana7.tiles/thumb.jpg" lat="43.77637700" lng="11.26051200" heading="338.6">
		
		<control bouncinglimits="calc:image.cube ? true : false" />

		<view hlookat="338.7" vlookat="0.0" fovtype="MFOV" fov="120" maxpixelzoom="2.0" fovmin="70" fovmax="140" limitview="auto" />

		<preview url="panos/nana7.tiles/preview.jpg" />

		<image prealign="0|338.7|0" if="!(webvr.isenabled OR device.mobilevr)">
			<cube url="panos/nana7.tiles/%s/l%l/%v/l%l_%s_%v_%h.jpg" multires="512,640,1152,2304" />
		</image>

		<image prealign="0|338.7|0" if="webvr.isenabled OR device.mobilevr">
			<cube url="panos/nana7.tiles/vr/pano_%s.jpg" />
		</image>

	</scene>


</krpano>
